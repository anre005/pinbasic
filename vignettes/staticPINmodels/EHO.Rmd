### EHO Model

This model is based on and extends the EKOP model presented in the previous section.
In contrast to the simpler model, the Poisson processes for uninformed buys and uninformed sells
are assumed to have unique intensities.
The expected number of uninformed buys equals $\intensuninfbuys$, whereas
the expected amount of uninformed sells is $\intensuninfsells$.
The splitting of arrival rates for noise traders
results in an extended parameter vector $\thetaeho$.
Hence, the EKOP model is nested in the extended setting for the special case that
$\intensuninfbuys = \intensuninfsells$.

The formula for computing the probability of informed trading slightly differs from equation \\ref{eq:pinekop}
since the new structure of model parameters needs to be incorporated,
$$
\begin{align}\label{eq:pineho}
\pintext &= \dfrac{\probinfevent \probbadnews \intensinf + \probinfevent (1 - \probbadnews) \intensinf}
                  {(1 - \probinfevent)(\intensuninfbuys + \intensuninfsells) + \probinfevent \probbadnews (\intensuninfbuys + \intensuninfsells) + \probinfevent (1 - \probbadnews) (\intensuninfbuys + \intensuninfsells) + \probinfevent \probbadnews \intensinf + \probinfevent (1 - \probbadnews) \intensinf} \notag \\
         &= \dfrac{\probinfevent \intensinf}{\intensuninfbuys + \intensuninfsells + \probinfevent \intensinf},
\end{align}
$$
We can utilize equation \\ref{eq:loglikelihoodEKOPconcrete} for deriving
the likelihood function in the extended EHO setting.
The joint density of observing $B_{\daysym}$ buys and $S_{\daysym}$ sells on
trading days $\daysym$ with $\daysym = 1, \dots, \totaldays$ in the extended setting is given by
$$
\begin{align}
  \log \likelihood\left(\thetaehoshort \mid \datasymbs \right) = &\sum\limits_{d=1}^{\totaldays}
  \log \Biggl( \left(1-\probinfevent\right) \left(\exp\left(-\intensuninfbuys \right)\dfrac{\intensuninfbuys^{B_{\daysym}}}{B_{\daysym}!}
  \exp\left(-\intensuninfsells \right)\dfrac{\intensuninfsells^{S_{\daysym}}}{S_{\daysym}!}\right) \notag \\
  & + \probinfevent \left(1-\probbadnews\right) \left(\exp\left(-(\intensuninfbuys + \intensinf) \right)\dfrac{(\intensuninfbuys + \intensinf)^{B_{\daysym}}}{B_{\daysym}!}
  \exp\left(-\intensuninfsells \right)\dfrac{\intensuninfsells^{S_{\daysym}}}{S_{\daysym}!}\right) \notag \\
  & + \probinfevent\probbadnews \left(\exp\left(-\intensuninfbuys \right)\dfrac{\intensuninfbuys^{B_{\daysym}}}{B_{\daysym}!}
  \exp\left(-(\intensuninfsells + \intensinf) \right)\dfrac{(\intensuninfsells + \intensinf)^{S_{\daysym}}}{S_{\daysym}!}\right) \Biggr). \label{eq:loglikelihoodEHOconcrete}
\end{align}
$$
The scenario tree shown for the simpler EKOP model  does not longer hold for the EHO model.
Relaxing the assumption of identical intensities for buys and sells initiated by noise traders
implies an updated version of the figure. 
<!-- % -->
<!-- \begin{figure} -->
<!--   \centering -->
<!--   \includegraphics[width = \textwidth]{tikzfigs/EHOtree.tikz} -->
<!--   \caption[Scenario Tree for EHO model] -->
<!--           {Scenario Tree for EHO model with different arrival rates of uninformed buys and -->
<!--            uninformed sells. -->
<!--            Information events, days on which private information hit the market, occur with probability -->
<!--            $\probinfevent$. -->
<!--            These private information has a negative direction with probability $\probbadnews$ (Bad-News) -->
<!--            and a positive direction with probability $1 - \probbadnews$ (Good-News). -->
<!--            On Bad-News (Good-News) days, the informed traders only sell (buy). -->
<!--            Uninformed traders buy equities with rate $\intensuninfbuys$, -->
<!--            and sell them with rate $\intensuninfsells$. -->
<!--            Information-based buys and sells both have an intensity of $\intensinf$.} -->
<!--   \label{fig:EHOtree} -->
<!-- \end{figure} -->
<!-- % -->


![EHO Scenario Tree](EHOtree.png)


The probabilities that the $k$-th observed transaction on trading day $\daysym$, $I_{k, \daysym}$,
is buyer- or seller-initiated, with respect to the trading days' conditions, are given as:
$$
\begin{aligned}
    \prsym\left(I_{k, \daysym} = B \mid \text{No-News} \right) &= \dfrac{\intensuninfbuys}{\intensuninfbuys + \intensuninfsells}\\
    \prsym\left(I_{k, \daysym} = S \mid \text{No-News} \right) &= \dfrac{\intensuninfsells}{\intensuninfbuys + \intensuninfsells}\\
    \prsym\left(I_{k, \daysym} = B \mid \text{Good-News} \right) &= \dfrac{\intensuninfbuys + \intensinf}{\intensuninfbuys + \intensuninfsells + \intensinf} \\
    \prsym\left(I_{k, \daysym} = S \mid \text{Good-News} \right) &= \dfrac{\intensuninfsells}{\intensuninfbuys + \intensuninfsells + \intensinf} \\
    \prsym\left(I_{k, \daysym} = B \mid \text{Bad-News} \right) &= \dfrac{\intensuninfbuys}{\intensuninfbuys + \intensuninfsells + \intensinf} \\
    \prsym\left(I_{k, \daysym} = S \mid \text{Bad-News} \right) &= \dfrac{\intensuninfsells + \intensinf}{\intensuninfbuys + \intensuninfsells + \intensinf}.
\end{aligned}
$$
Contrary to the simpler model, no-news days do not longer represent
coin-flipping scenarios for the direction of transactions.
If buyer- or seller-initiated transactions prevail is determined by the ratio of the parameters
$\intensuninfbuys$ and $\intensuninfsells$.
If $\intensuninfbuys > \intensuninfsells$ ($\intensuninfbuys < \intensuninfsells$) we expect the majority
of observed trades to be buys (sells). 

Optimizations may also suffer from overflow or underflow errors due to the same reasons mentioned
for the EKOP model.
Terms potentially leading the computations to overflow are $\intensuninfbuys^{B_{\daysym}}$,
$\intensuninfsells^{S_{\daysym}}$, $(\intensuninfbuys + \intensinf)^{B_{\daysym}}$ and
$(\intensuninfsells + \intensinf)^{S_{\daysym}}$ and all terms in which the factorial function is involved.
Underflow errors can be caused by exponential functions if arguments are too small.